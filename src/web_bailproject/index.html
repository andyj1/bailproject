<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>One single section - fullPage.js</title>
    <meta name="author" content="Alvaro Trigo Lopez" />
    <meta name="description" content="fullPage One single section." />
    <meta name="keywords" content="fullpage,One, Single, Section" />
    <meta name="Resource-type" content="Document" />

    <link rel="stylesheet" type="text/css" href="css/fullpage.css" />
    <link rel="stylesheet" type="text/css" href="examples.css" />
    <style>
      /* Style for our header texts
	* --------------------------------------- */
      h1 {
        font-size: 5em;
        font-family: arial, helvetica;
        color: #fff;
        margin: 0;
        padding: 40px 0 0 0;
      }
      .intro p {
        color: #fff;
        padding: 40px 0 0 0;
      }
      .wrap {
        margin-left: auto;
        margin-right: auto;
        width: 980px;
        position: relative;
        padding: 20px 0 20px 0;
      }
      .wrap h1 {
        font-size: 2.3em;
        color: #333;
        padding: 30px 0 10px 0;
      }
      .wrap p {
        font-size: 16px;
        padding: 0 0 10px 0;
      }
      .box {
        display: block;
        background: #f2f2f2;
        border: 1px solid #ccc;
        padding: 20px;
        margin: 20px 0;
      }

      /* Centered texts in each section
	* --------------------------------------- */
      .section {
        text-align: center;
      }

      /* Bottom menu
	* --------------------------------------- */
      #infoMenu li a {
        color: #000;
      }
      .maps {
        margin: auto;
        width: 80%;
        /* border: 3px solid green; */
        padding: 10px;
      }
    </style>

    <!--[if IE]>
      <script type="text/javascript">
        var console = { log: function() {} };
      </script>
    <![endif]-->
  </head>
  <body>
    <div id="wrap">
      <header id="header" style="padding-left:20px">
        <div>
          <h1>
            <a href="https://bailproject.org/"
              ><img src="img/thebailproject_logo.png" alt="TBP Logo"
            /></a>
          </h1>
          <!-- <div> -->
          <a> ECE491 Data Science For Social Good (Sp 2020)</a>
          <br />
          <a>
            Zo&euml; Bowhay, Andy Jeong, Minyoung Na, Stella Blue Ponzulogo,
            Justin Rooney</a
          >
          <!-- </div> -->
        </div>
      </header>
      <ul id="menu">
        <li data-menuanchor="firstPage">
          <a href="#firstPage">Overall</a>
        </li>
        <li data-menuanchor="secondPage">
          <a href="#secondPage">Louisiana</a>
        </li>
        <li data-menuanchor="3rdPage"><a href="#3rdPage">Michigan</a></li>
        <li data-menuanchor="4thPage"><a href="#4thPage">Washington</a></li>
        <li data-menuanchor="5thPage"><a href="#5thPage">New York</a></li>
      </ul>
    </div>

    <div class="maps">
      <h3>
        <b
          >The data we received from The Bail Project comes from four different
          states:</b
        >
      </h3>
      <div id="map" class="united-states">
        <h3 id="state-name"></h3>
      </div>
    </div>
    <!-- Raphaël JS Map Here -->

    <script src="js/raphael-min.js"></script>
    <script src="js/usasvg.js"></script>

    <div id="fullpage">
      <div class="section " id="section0">
        <div class="intro">
          <h1>Demographics</h1>
          <br />
          <h5>Arkansas</h5>
          <div
            id="selectSort"
            ,
            class="image1"
            style="height:500px; margin-top:-200px; margin-left:500px;"
          ></div>
          <h5>Louisiana</h5>
          <div
            id="selectSort2"
            ,
            class="image2"
            style="height:500px; margin-top:-250px; margin-left:600px;"
          ></div>
          <h5>New York</h5>
          <div
            id="selectSort3"
            ,
            class="image3"
            style="height:500px; margin-top:-250px; margin-left:600px;"
          ></div>

          <script src="js/arcjs.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
          <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
        </div>
      </div>
      <div
        class="section"
        id="section1"
        style=" overflow-x: scroll; overflow-y:hidden; white-space: nowrap;"
      >
        <div class="slide" id="slide1">
          <div class="intro">
            <h1>Other Info</h1>
            <p>
              Enter info here
            </p>
          </div>
        </div>
        <div
          class="slide"
          id="slide2"
          style="width: auto; white-space: nowrap;"
        >
          <h1>Page2 - 2</h1>
          <img src="imgs/iphone-blue.png" alt="iphone" id="iphone-two" />
        </div>
      </div>
      <div class="section" id="section2">
        <div class="intro">
          <h1>Other Info</h1>
          <p>
            Enter info here
          </p>
        </div>
      </div>
    </div>

    <div class="wrap">
      <h1>Additional info here</h1>

      Just place the rest of your page after the fullpage wrapper and use the
      option `fitToSection:false` and `autoScrolling:false`. And enjoy a great
      single slider.
      <!--

      <script src="https://gist.github.com/alvarotrigo/368e6d6ad3c5c0e98d3c.js"></script>
      <script src="https://gist.github.com/alvarotrigo/c74366b59ecba2f9c3da.js"></script>
      
      <h1>Rest of your site</h1>

      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas a sem
        ultrices neque vehicula fermentum a sit amet nulla. Donec sed tellus
        tempor ligula condimentum placerat. Vivamus placerat magna nisi, eu
        elementum risus imperdiet sit amet. Nunc varius dictum porttitor. Morbi
        rhoncus magna in quam fringilla fringilla in in odio. Quisque fringilla
        ante vitae tellus fringilla, condimentum tristique mi pharetra. Aenean
        ultricies odio at erat facilisis tincidunt. Fusce tempor auctor justo,
        nec facilisis quam vehicula vel. Aenean non mattis purus, eget lobortis
        odio. Cum sociis natoque penatibus et magnis dis parturient montes,
        nascetur ridiculus mus. Nullam cursus elit nec aliquam consequat.
      </p>
      <p>
        Nullam sem orci, tincidunt non lorem quis, ultricies blandit nisl. Donec
        eget sollicitudin tortor. Integer ut orci sit amet ipsum porta feugiat
        sit amet ut nulla. Vestibulum auctor, tortor sed scelerisque
        consectetur, nisl tellus placerat tortor, non euismod nisi risus vitae
        ipsum. Morbi a velit purus. Nam euismod porta sapien, sed scelerisque
        nulla lacinia vitae. Interdum et malesuada fames ac ante ipsum primis in
        faucibus. Aliquam at eleifend ligula, in eleifend sapien.
      </p>
      <div class="box">
        In elementum nec quam et eleifend. Ut nec erat fermentum, mattis leo
        non, fringilla tellus. Integer at dui nibh. Etiam facilisis fermentum
        turpis. Nulla malesuada iaculis nisl, ac accumsan felis pulvinar ut.
        Proin porttitor nulla libero, vel tristique erat faucibus quis. Aliquam
        pharetra enim et sapien bibendum, interdum viverra lectus sagittis.
        Vivamus pharetra, risus quis malesuada interdum, mi mauris dignissim mi,
        ac hendrerit orci nulla vel felis. Vivamus dapibus, nisi vel viverra
        tincidunt, ligula nunc sagittis elit, eget lacinia tellus velit et leo.
        Curabitur a tortor pretium, aliquam justo gravida, commodo ipsum. In
        fermentum lorem eu tincidunt consequat. Donec nec blandit ipsum, id
        scelerisque velit. Aenean vel ultrices ligula, at imperdiet dolor. Sed
        euismod turpis et nibh adipiscing feugiat. Etiam diam leo, sollicitudin
        eu suscipit non, laoreet sit amet dui. In augue purus, semper in blandit
        ut, suscipit vehicula tortor.
      </div>
      <p>
        Praesent id varius neque. Nunc risus elit, tincidunt eu nulla vitae,
        adipiscing porta nibh. Pellentesque dignissim dolor ligula, eu
        vestibulum justo elementum ac. In a risus ullamcorper, iaculis lectus
        non, condimentum elit. Pellentesque ac felis nec mauris venenatis
        elementum. In porttitor mauris sit amet posuere scelerisque. Nunc
        interdum arcu sit amet libero fermentum, nec consequat risus dignissim.
      </p>
      <p>
        Curabitur dui elit, tristique eget venenatis et, scelerisque mattis
        arcu. Pellentesque lectus orci, tempus in enim et, condimentum rutrum
        magna. Mauris nec eros viverra, facilisis nibh ut, sodales urna.
        Pellentesque nec neque in ipsum imperdiet egestas vitae vel augue.
        Integer felis eros, dictum at eleifend aliquet, lacinia non neque.
        Curabitur eget condimentum urna, eget sodales lectus. Maecenas blandit
        ac neque id elementum. Phasellus ultricies vestibulum elit ut sagittis.
        Nam ut porta mi.
      </p>

      <h1>Rest of your site</h1>

      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas a sem
        ultrices neque vehicula fermentum a sit amet nulla. Donec sed tellus
        tempor ligula condimentum placerat. Vivamus placerat magna nisi, eu
        elementum risus imperdiet sit amet. Nunc varius dictum porttitor. Morbi
        rhoncus magna in quam fringilla fringilla in in odio. Quisque fringilla
        ante vitae tellus fringilla, condimentum tristique mi pharetra. Aenean
        ultricies odio at erat facilisis tincidunt. Fusce tempor auctor justo,
        nec facilisis quam vehicula vel. Aenean non mattis purus, eget lobortis
        odio. Cum sociis natoque penatibus et magnis dis parturient montes,
        nascetur ridiculus mus. Nullam cursus elit nec aliquam consequat.
      </p>
      <p>
        Nullam sem orci, tincidunt non lorem quis, ultricies blandit nisl. Donec
        eget sollicitudin tortor. Integer ut orci sit amet ipsum porta feugiat
        sit amet ut nulla. Vestibulum auctor, tortor sed scelerisque
        consectetur, nisl tellus placerat tortor, non euismod nisi risus vitae
        ipsum. Morbi a velit purus. Nam euismod porta sapien, sed scelerisque
        nulla lacinia vitae. Interdum et malesuada fames ac ante ipsum primis in
        faucibus. Aliquam at eleifend ligula, in eleifend sapien.
      </p>
      <p>
        In elementum nec quam et eleifend. Ut nec erat fermentum, mattis leo
        non, fringilla tellus. Integer at dui nibh. Etiam facilisis fermentum
        turpis. Nulla malesuada iaculis nisl, ac accumsan felis pulvinar ut.
        Proin porttitor nulla libero, vel tristique erat faucibus quis. Aliquam
        pharetra enim et sapien bibendum, interdum viverra lectus sagittis.
        Vivamus pharetra, risus quis malesuada interdum, mi mauris dignissim mi,
        ac hendrerit orci nulla vel felis. Vivamus dapibus, nisi vel viverra
        tincidunt, ligula nunc sagittis elit, eget lacinia tellus velit et leo.
        Curabitur a tortor pretium, aliquam justo gravida, commodo ipsum. In
        fermentum lorem eu tincidunt consequat. Donec nec blandit ipsum, id
        scelerisque velit. Aenean vel ultrices ligula, at imperdiet dolor. Sed
        euismod turpis et nibh adipiscing feugiat. Etiam diam leo, sollicitudin
        eu suscipit non, laoreet sit amet dui. In augue purus, semper in blandit
        ut, suscipit vehicula tortor.
      </p>
      <p>
        Praesent id varius neque. Nunc risus elit, tincidunt eu nulla vitae,
        adipiscing porta nibh. Pellentesque dignissim dolor ligula, eu
        vestibulum justo elementum ac. In a risus ullamcorper, iaculis lectus
        non, condimentum elit. Pellentesque ac felis nec mauris venenatis
        elementum. In porttitor mauris sit amet posuere scelerisque. Nunc
        interdum arcu sit amet libero fermentum, nec consequat risus dignissim.
      </p>
      <div class="box">
        Curabitur dui elit, tristique eget venenatis et, scelerisque mattis
        arcu. Pellentesque lectus orci, tempus in enim et, condimentum rutrum
        magna. Mauris nec eros viverra, facilisis nibh ut, sodales urna.
        Pellentesque nec neque in ipsum imperdiet egestas vitae vel augue.
        Integer felis eros, dictum at eleifend aliquet, lacinia non neque.
        Curabitur eget condimentum urna, eget sodales lectus. Maecenas blandit
        ac neque id elementum. Phasellus ultricies vestibulum elit ut sagittis.
        Nam ut porta mi.
      </div>

      <h1>Rest of your site</h1>

      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas a sem
        ultrices neque vehicula fermentum a sit amet nulla. Donec sed tellus
        tempor ligula condimentum placerat. Vivamus placerat magna nisi, eu
        elementum risus imperdiet sit amet. Nunc varius dictum porttitor. Morbi
        rhoncus magna in quam fringilla fringilla in in odio. Quisque fringilla
        ante vitae tellus fringilla, condimentum tristique mi pharetra. Aenean
        ultricies odio at erat facilisis tincidunt. Fusce tempor auctor justo,
        nec facilisis quam vehicula vel. Aenean non mattis purus, eget lobortis
        odio. Cum sociis natoque penatibus et magnis dis parturient montes,
        nascetur ridiculus mus. Nullam cursus elit nec aliquam consequat.
      </p>
      <p>
        Nullam sem orci, tincidunt non lorem quis, ultricies blandit nisl. Donec
        eget sollicitudin tortor. Integer ut orci sit amet ipsum porta feugiat
        sit amet ut nulla. Vestibulum auctor, tortor sed scelerisque
        consectetur, nisl tellus placerat tortor, non euismod nisi risus vitae
        ipsum. Morbi a velit purus. Nam euismod porta sapien, sed scelerisque
        nulla lacinia vitae. Interdum et malesuada fames ac ante ipsum primis in
        faucibus. Aliquam at eleifend ligula, in eleifend sapien.
      </p>
      <p>
        In elementum nec quam et eleifend. Ut nec erat fermentum, mattis leo
        non, fringilla tellus. Integer at dui nibh. Etiam facilisis fermentum
        turpis. Nulla malesuada iaculis nisl, ac accumsan felis pulvinar ut.
        Proin porttitor nulla libero, vel tristique erat faucibus quis. Aliquam
        pharetra enim et sapien bibendum, interdum viverra lectus sagittis.
        Vivamus pharetra, risus quis malesuada interdum, mi mauris dignissim mi,
        ac hendrerit orci nulla vel felis. Vivamus dapibus, nisi vel viverra
        tincidunt, ligula nunc sagittis elit, eget lacinia tellus velit et leo.
        Curabitur a tortor pretium, aliquam justo gravida, commodo ipsum. In
        fermentum lorem eu tincidunt consequat. Donec nec blandit ipsum, id
        scelerisque velit. Aenean vel ultrices ligula, at imperdiet dolor. Sed
        euismod turpis et nibh adipiscing feugiat. Etiam diam leo, sollicitudin
        eu suscipit non, laoreet sit amet dui. In augue purus, semper in blandit
        ut, suscipit vehicula tortor.
      </p>
      <p>
        Praesent id varius neque. Nunc risus elit, tincidunt eu nulla vitae,
        adipiscing porta nibh. Pellentesque dignissim dolor ligula, eu
        vestibulum justo elementum ac. In a risus ullamcorper, iaculis lectus
        non, condimentum elit. Pellentesque ac felis nec mauris venenatis
        elementum. In porttitor mauris sit amet posuere scelerisque. Nunc
        interdum arcu sit amet libero fermentum, nec consequat risus dignissim.
      </p>
      <p>
        Curabitur dui elit, tristique eget venenatis et, scelerisque mattis
        arcu. Pellentesque lectus orci, tempus in enim et, condimentum rutrum
        magna. Mauris nec eros viverra, facilisis nibh ut, sodales urna.
        Pellentesque nec neque in ipsum imperdiet egestas vitae vel augue.
        Integer felis eros, dictum at eleifend aliquet, lacinia non neque.
        Curabitur eget condimentum urna, eget sodales lectus. Maecenas blandit
        ac neque id elementum. Phasellus ultricies vestibulum elit ut sagittis.
        Nam ut porta mi.
      </p> -->
    </div>

    <script type="text/javascript" src="js/fullpage.js"></script>
    <script type="text/javascript" src="examples.js"></script>

    <script type="text/javascript">
      var myFullpage = new fullpage("#fullpage", {
        anchors: ["firstPage", "secondPage", "thirdPage"],
        // sectionsColor: ["#4A6FB1", "#4A6FB1", "#333333"],
        sectionsColor: ["#ccccff", "#4A6FB1", "#333333"],
        autoScrolling: false,
        css3: true,
        fitToSection: false
      });
    </script>

    <!-- arc diagram scripts -->

    <script>
      var i,
        width = 1000, //960,
        height = 500,
        transitionTime = 1000,
        spacing = 50,
        margin = 50,
        // offsets in rotation
        offsetx = -30,
        offsety = 30,
        nodeY = 400,
        nodes = arkansas.nodes,
        links = arkansas.links,
        colors = d3.scale.category20(),
        τ = 2 * Math.PI; // http://tauday.com/tau-manifesto

      var svg = d3
        .select("div.image1")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("align", "center");

      function mapRange(value, inMin, inMax, outMin, outMax) {
        var inVal = Math.min(Math.max(value, inMin), inMax);
        return outMin + (outMax - outMin) * ((inVal - inMin) / (inMax - inMin));
      }

      // Set each node's value to the sum of all incoming and outgoing link values
      var nodeValMin = 100000000,
        nodeValMax = 0;
      for (i = 0; i < nodes.length; i++) {
        nodes[i].value = 0;
        nodes[i].displayOrder = i;
      }
      for (i = 0; i < links.length; i++) {
        var link = links[i];
        value = link.value;
        nodes[link.source].value += link.value;
        nodes[link.target].value += link.value;
      }
      for (i = 0; i < nodes.length; i++) {
        nodeValMin = Math.min(nodeValMin, nodes[i].value);
        nodeValMax = Math.max(nodeValMax, nodes[i].value);
      }

      var arcBuilder = d3.svg
        .arc()
        .startAngle(-τ / 4)
        .endAngle(τ / 4);
      arcBuilder.setRadii = function(d) {
        var arcHeight = 0.5 * Math.abs(d.x2 - d.x1);
        this.innerRadius(arcHeight - d.thickness / 2).outerRadius(
          arcHeight + d.thickness / 2
        );
      };
      function arcTranslation(d) {
        return "translate(" + (d.x1 + d.x2) / 2 + "," + nodeY + ")";
      }
      function nodeDisplayX(node) {
        return node.displayOrder * spacing + margin;
      }

      var path;

      function update() {
        // DATA JOIN
        path = svg.selectAll("path").data(links);
        // UPDATE
        path
          .transition()
          .duration(transitionTime)
          .call(pathTween, null);
        // ENTER
        path
          .enter()
          .append("path")
          .attr("transform", function(d, i) {
            d.x1 = nodeDisplayX(nodes[d.target]);
            d.x2 = nodeDisplayX(nodes[d.source]);
            return arcTranslation(d);
          })
          .attr("d", function(d, i) {
            d.thickness = 1 + d.value;
            arcBuilder.setRadii(d);
            return arcBuilder();
          });

        // DATA JOIN
        var circle = svg.selectAll("circle").data(nodes);
        // UPDATE
        circle
          .transition()
          .duration(transitionTime)
          .attr("cx", function(d, i) {
            return nodeDisplayX(d);
          });
        // ENTER
        circle
          .enter()
          .append("circle")
          .attr("cy", nodeY)
          .attr("cx", function(d, i) {
            return nodeDisplayX(d);
          })
          .attr("r", function(d, i) {
            return mapRange(d.value, nodeValMin, nodeValMax, 2.5, 13);
          })
          .attr("fill", function(d, i) {
            return colors(d.group);
          })
          .attr("stroke", function(d, i) {
            return d3.rgb(colors(d.group)).darker(1);
          });

        function textTransform(node) {
          return (
            "rotate(-45 " +
            (nodeDisplayX(node) - offsetx) +
            " " +
            (nodeY + offsety) +
            ")"
          );
        }
        // DATA JOIN
        var text = svg.selectAll("text").data(nodes);
        // UPDATE
        text
          .transition()
          .duration(transitionTime)
          .attr("x", function(d, i) {
            return nodeDisplayX(d) - 5;
          })
          .attr("transform", function(d, i) {
            return textTransform(d);
          });
        // ENTER
        text
          .enter()
          .append("text")
          .attr("y", nodeY + 12)
          .attr("x", function(d, i) {
            return nodeDisplayX(d) - 5;
          })
          .attr("transform", function(d, i) {
            return textTransform(d);
          })
          .attr("font-size", "10px")
          .text(function(d, i) {
            return d.nodeName;
          });
      }

      doSort(0);
      update();

      function pathTween(transition, dummy) {
        transition.attrTween("d", function(d) {
          var interpolateX1 = d3.interpolate(
            d.x1,
            nodeDisplayX(nodes[d.target])
          );
          var interpolateX2 = d3.interpolate(
            d.x2,
            nodeDisplayX(nodes[d.source])
          );
          return function(t) {
            d.x1 = interpolateX1(t);
            d.x2 = interpolateX2(t);
            arcBuilder.setRadii(d);
            return arcBuilder();
          };
        });

        transition.attrTween("transform", function(d) {
          var interpolateX1 = d3.interpolate(
            d.x1,
            nodeDisplayX(nodes[d.target])
          );
          var interpolateX2 = d3.interpolate(
            d.x2,
            nodeDisplayX(nodes[d.source])
          );
          return function(t) {
            d.x1 = interpolateX1(t);
            d.x2 = interpolateX2(t);
            return arcTranslation(d);
          };
        });
      }

      d3.select("#selectSort").on("change", function() {
        doSort(this.selectedIndex);
        update();
      });

      function doSort(sortMethod) {
        var nodeMap = [],
          sortFunciton;

        for (i = 0; i < nodes.length; i++) {
          var node = $.extend({ index: i }, nodes[i]); // Shallow copy
          nodeMap.push(node);
        }

        if (sortMethod == 0) {
          // GROUP
          sortFunction = function(a, b) {
            return b.group - a.group;
          };
        } else if (sortMethod == 1) {
          // FREQUENCY
          sortFunction = function(a, b) {
            return b.value - a.value;
          };
        } else if (sortMethod == 2) {
          // ALPHABETICAL
          sortFunction = function(a, b) {
            return a.nodeName.localeCompare(b.nodeName);
          };
        }

        nodeMap.sort(sortFunction);
        for (i = 0; i < nodeMap.length; i++) {
          nodes[nodeMap[i].index].displayOrder = i;
        }
      }
    </script>

    <!-- Louisiana -->

    <script>
      var i,
        width = 1000, //960,
        height = 500,
        transitionTime = 1000,
        spacing = 50,
        margin = 50,
        // offsets in rotation
        offsetx = -30,
        offsety = 30,
        nodeY = 400,
        nodes = louisiana.nodes,
        links = louisiana.links,
        colors = d3.scale.category20(),
        τ = 2 * Math.PI; // http://tauday.com/tau-manifesto

      var svg = d3
        .select("div.image2")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("align", "center");

      function mapRange(value, inMin, inMax, outMin, outMax) {
        var inVal = Math.min(Math.max(value, inMin), inMax);
        return outMin + (outMax - outMin) * ((inVal - inMin) / (inMax - inMin));
      }

      // Set each node's value to the sum of all incoming and outgoing link values
      var nodeValMin = 100000000,
        nodeValMax = 0;
      for (i = 0; i < nodes.length; i++) {
        nodes[i].value = 0;
        nodes[i].displayOrder = i;
      }
      for (i = 0; i < links.length; i++) {
        var link = links[i];
        value = link.value;
        nodes[link.source].value += link.value;
        nodes[link.target].value += link.value;
      }
      for (i = 0; i < nodes.length; i++) {
        nodeValMin = Math.min(nodeValMin, nodes[i].value);
        nodeValMax = Math.max(nodeValMax, nodes[i].value);
      }

      var arcBuilder = d3.svg
        .arc()
        .startAngle(-τ / 4)
        .endAngle(τ / 4);
      arcBuilder.setRadii = function(d) {
        var arcHeight = 0.5 * Math.abs(d.x2 - d.x1);
        this.innerRadius(arcHeight - d.thickness / 2).outerRadius(
          arcHeight + d.thickness / 2
        );
      };
      function arcTranslation(d) {
        return "translate(" + (d.x1 + d.x2) / 2 + "," + nodeY + ")";
      }
      function nodeDisplayX(node) {
        return node.displayOrder * spacing + margin;
      }

      var path;

      function update2() {
        // DATA JOIN
        path = svg.selectAll("path").data(links);
        // update2
        path
          .transition()
          .duration(transitionTime)
          .call(pathTween, null);
        // ENTER
        path
          .enter()
          .append("path")
          .attr("transform", function(d, i) {
            d.x1 = nodeDisplayX(nodes[d.target]);
            d.x2 = nodeDisplayX(nodes[d.source]);
            return arcTranslation(d);
          })
          .attr("d", function(d, i) {
            d.thickness = 1 + d.value;
            arcBuilder.setRadii(d);
            return arcBuilder();
          });

        // DATA JOIN
        var circle = svg.selectAll("circle").data(nodes);
        // update2
        circle
          .transition()
          .duration(transitionTime)
          .attr("cx", function(d, i) {
            return nodeDisplayX(d);
          });
        // ENTER
        circle
          .enter()
          .append("circle")
          .attr("cy", nodeY)
          .attr("cx", function(d, i) {
            return nodeDisplayX(d);
          })
          .attr("r", function(d, i) {
            return mapRange(d.value, nodeValMin, nodeValMax, 2.5, 13);
          })
          .attr("fill", function(d, i) {
            return colors(d.group);
          })
          .attr("stroke", function(d, i) {
            return d3.rgb(colors(d.group)).darker(1);
          });

        function textTransform(node) {
          return (
            "rotate(-45 " +
            (nodeDisplayX(node) - offsetx) +
            " " +
            (nodeY + offsety) +
            ")"
          );
        }
        // DATA JOIN
        var text = svg.selectAll("text").data(nodes);
        // update2
        text
          .transition()
          .duration(transitionTime)
          .attr("x", function(d, i) {
            return nodeDisplayX(d) - 5;
          })
          .attr("transform", function(d, i) {
            return textTransform(d);
          });
        // ENTER
        text
          .enter()
          .append("text")
          .attr("y", nodeY + 12)
          .attr("x", function(d, i) {
            return nodeDisplayX(d) - 5;
          })
          .attr("transform", function(d, i) {
            return textTransform(d);
          })
          .attr("font-size", "10px")
          .text(function(d, i) {
            return d.nodeName;
          });
      }

      doSort(0);
      update2();

      function pathTween(transition, dummy) {
        transition.attrTween("d", function(d) {
          var interpolateX1 = d3.interpolate(
            d.x1,
            nodeDisplayX(nodes[d.target])
          );
          var interpolateX2 = d3.interpolate(
            d.x2,
            nodeDisplayX(nodes[d.source])
          );
          return function(t) {
            d.x1 = interpolateX1(t);
            d.x2 = interpolateX2(t);
            arcBuilder.setRadii(d);
            return arcBuilder();
          };
        });

        transition.attrTween("transform", function(d) {
          var interpolateX1 = d3.interpolate(
            d.x1,
            nodeDisplayX(nodes[d.target])
          );
          var interpolateX2 = d3.interpolate(
            d.x2,
            nodeDisplayX(nodes[d.source])
          );
          return function(t) {
            d.x1 = interpolateX1(t);
            d.x2 = interpolateX2(t);
            return arcTranslation(d);
          };
        });
      }

      d3.select("#selectSort2").on("change", function() {
        doSort(this.selectedIndex);
        update2();
      });

      function doSort(sortMethod) {
        var nodeMap = [],
          sortFunciton;

        for (i = 0; i < nodes.length; i++) {
          var node = $.extend({ index: i }, nodes[i]); // Shallow copy
          nodeMap.push(node);
        }

        if (sortMethod == 0) {
          // GROUP
          sortFunction = function(a, b) {
            return b.group - a.group;
          };
        } else if (sortMethod == 1) {
          // FREQUENCY
          sortFunction = function(a, b) {
            return b.value - a.value;
          };
        } else if (sortMethod == 2) {
          // ALPHABETICAL
          sortFunction = function(a, b) {
            return a.nodeName.localeCompare(b.nodeName);
          };
        }

        nodeMap.sort(sortFunction);
        for (i = 0; i < nodeMap.length; i++) {
          nodes[nodeMap[i].index].displayOrder = i;
        }
      }
    </script>

    <!-- New York -->

    <script>
      var i,
        width = 1000, //960,
        height = 500,
        transitionTime = 1000,
        spacing = 50,
        margin = 50,
        // offsets in rotation
        offsetx = -30,
        offsety = 30,
        nodeY = 400,
        nodes = newyork.nodes,
        links = newyork.links,
        colors = d3.scale.category20(),
        τ = 2 * Math.PI; // http://tauday.com/tau-manifesto

      var svg = d3
        .select("div.image3")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("align", "center");

      function mapRange(value, inMin, inMax, outMin, outMax) {
        var inVal = Math.min(Math.max(value, inMin), inMax);
        return outMin + (outMax - outMin) * ((inVal - inMin) / (inMax - inMin));
      }

      // Set each node's value to the sum of all incoming and outgoing link values
      var nodeValMin = 100000000,
        nodeValMax = 0;
      for (i = 0; i < nodes.length; i++) {
        nodes[i].value = 0;
        nodes[i].displayOrder = i;
      }
      for (i = 0; i < links.length; i++) {
        var link = links[i];
        value = link.value;
        nodes[link.source].value += link.value;
        nodes[link.target].value += link.value;
      }
      for (i = 0; i < nodes.length; i++) {
        nodeValMin = Math.min(nodeValMin, nodes[i].value);
        nodeValMax = Math.max(nodeValMax, nodes[i].value);
      }

      var arcBuilder = d3.svg
        .arc()
        .startAngle(-τ / 4)
        .endAngle(τ / 4);
      arcBuilder.setRadii = function(d) {
        var arcHeight = 0.5 * Math.abs(d.x2 - d.x1);
        this.innerRadius(arcHeight - d.thickness / 2).outerRadius(
          arcHeight + d.thickness / 2
        );
      };
      function arcTranslation(d) {
        return "translate(" + (d.x1 + d.x2) / 2 + "," + nodeY + ")";
      }
      function nodeDisplayX(node) {
        return node.displayOrder * spacing + margin;
      }

      var path;

      function update3() {
        // DATA JOIN
        path = svg.selectAll("path").data(links);
        // update3
        path
          .transition()
          .duration(transitionTime)
          .call(pathTween, null);
        // ENTER
        path
          .enter()
          .append("path")
          .attr("transform", function(d, i) {
            d.x1 = nodeDisplayX(nodes[d.target]);
            d.x2 = nodeDisplayX(nodes[d.source]);
            return arcTranslation(d);
          })
          .attr("d", function(d, i) {
            d.thickness = 1 + d.value;
            arcBuilder.setRadii(d);
            return arcBuilder();
          });

        // DATA JOIN
        var circle = svg.selectAll("circle").data(nodes);
        // update3
        circle
          .transition()
          .duration(transitionTime)
          .attr("cx", function(d, i) {
            return nodeDisplayX(d);
          });
        // ENTER
        circle
          .enter()
          .append("circle")
          .attr("cy", nodeY)
          .attr("cx", function(d, i) {
            return nodeDisplayX(d);
          })
          .attr("r", function(d, i) {
            return mapRange(d.value, nodeValMin, nodeValMax, 2.5, 13);
          })
          .attr("fill", function(d, i) {
            return colors(d.group);
          })
          .attr("stroke", function(d, i) {
            return d3.rgb(colors(d.group)).darker(1);
          });

        function textTransform(node) {
          return (
            "rotate(-45 " +
            (nodeDisplayX(node) - offsetx) +
            " " +
            (nodeY + offsety) +
            ")"
          );
        }
        // DATA JOIN
        var text = svg.selectAll("text").data(nodes);
        // update3
        text
          .transition()
          .duration(transitionTime)
          .attr("x", function(d, i) {
            return nodeDisplayX(d) - 5;
          })
          .attr("transform", function(d, i) {
            return textTransform(d);
          });
        // ENTER
        text
          .enter()
          .append("text")
          .attr("y", nodeY + 12)
          .attr("x", function(d, i) {
            return nodeDisplayX(d) - 5;
          })
          .attr("transform", function(d, i) {
            return textTransform(d);
          })
          .attr("font-size", "10px")
          .text(function(d, i) {
            return d.nodeName;
          });
      }

      doSort(0);
      update3();

      function pathTween(transition, dummy) {
        transition.attrTween("d", function(d) {
          var interpolateX1 = d3.interpolate(
            d.x1,
            nodeDisplayX(nodes[d.target])
          );
          var interpolateX2 = d3.interpolate(
            d.x2,
            nodeDisplayX(nodes[d.source])
          );
          return function(t) {
            d.x1 = interpolateX1(t);
            d.x2 = interpolateX2(t);
            arcBuilder.setRadii(d);
            return arcBuilder();
          };
        });

        transition.attrTween("transform", function(d) {
          var interpolateX1 = d3.interpolate(
            d.x1,
            nodeDisplayX(nodes[d.target])
          );
          var interpolateX2 = d3.interpolate(
            d.x2,
            nodeDisplayX(nodes[d.source])
          );
          return function(t) {
            d.x1 = interpolateX1(t);
            d.x2 = interpolateX2(t);
            return arcTranslation(d);
          };
        });
      }

      d3.select("#selectSort2").on("change", function() {
        doSort(this.selectedIndex);
        update3();
      });

      function doSort(sortMethod) {
        var nodeMap = [],
          sortFunciton;

        for (i = 0; i < nodes.length; i++) {
          var node = $.extend({ index: i }, nodes[i]); // Shallow copy
          nodeMap.push(node);
        }

        if (sortMethod == 0) {
          // GROUP
          sortFunction = function(a, b) {
            return b.group - a.group;
          };
        } else if (sortMethod == 1) {
          // FREQUENCY
          sortFunction = function(a, b) {
            return b.value - a.value;
          };
        } else if (sortMethod == 2) {
          // ALPHABETICAL
          sortFunction = function(a, b) {
            return a.nodeName.localeCompare(b.nodeName);
          };
        }

        nodeMap.sort(sortFunction);
        for (i = 0; i < nodeMap.length; i++) {
          nodes[nodeMap[i].index].displayOrder = i;
        }
      }
    </script>
  </body>
</html>
